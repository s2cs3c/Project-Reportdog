import { api } from 'boot/axios'

export default {
  getVulnerabilities: function() {
    return api.get(`vulnerabilities`)
  },

  exportVulnerabilities: function() {
    return api.get(`vulnerabilities/export`)
  },

  getVulnByLanguage: function(locale) {
    return api.get(`vulnerabilities/${locale}`)
  },

  createVulnerabilities: function(vulnerabilities) {
    return api.post('vulnerabilities', vulnerabilities)
  },

  deleteVulnerability: function(vulnerabilityId) {
    return api.delete(`vulnerabilities/${vulnerabilityId}`)
  },

  deleteAllVulnerabilities: function() {
    return api.delete(`vulnerabilities`)
  },

  updateVulnerability: function(vulnerabilityId, vulnerability) {
    return api.put(`vulnerabilities/${vulnerabilityId}`, vulnerability)
  },

  backupFinding: function(locale, finding) {
    return api.post(`vulnerabilities/finding/${locale}`, finding)
  },

  getVulnUpdates: function(vulnId) {
    return api.get(`vulnerabilities/updates/${vulnId}`)
  },

  // Merge multiple vulnerabilities into a new one
  // ids: array of vulnerability IDs to merge
  // title: title for the merged vulnerability (default: "Merged Findings")
  // locale: locale for the merged vulnerability
  mergeVulnerabilities: function(ids, title, locale) {
    return api.post('vulnerabilities/merge', { ids: ids, title: title, locale: locale })
  },

  // Import vulnerabilities from Nessus XML file
  importNessus: function(file, locale) {
    const formData = new FormData()
    formData.append('file', file)
    formData.append('locale', locale)
    return api.post('vulnerabilities/import/nessus', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    })
  },

  // Import vulnerabilities from Nessus XML file (via data route)
  importNessusData: function(file, locale) {
    const formData = new FormData()
    formData.append('file', file)
    formData.append('locale', locale)
    return api.post('data/import/nessus', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    })
  },

  // Bulk approve multiple vulnerabilities
  bulkApprove: function(ids) {
    return api.put('vulnerabilities/bulk-approve', { ids: ids })
  }
}